#ifndef EnvH
#define EnvH
#include <stdint.h>
#include "cuda_runtime.h"

#define CCSRRelSize 7
#define CCSRVertSize (32 - CCSRRelSize)
#define GPUfnAlloc 600'000'000
#define MAXSCANSIZE 550'000'000
#define MEMLIMIT 24'000'000'000

#define ISOSOLVE
#define SHORTREL
#define GPUDEBUG
//#define BATCHING

#define HNDEBUG

#if (CUDART_VERSION < 11030)
template<class T>
__host__ cudaError_t cudaMallocAsync(T** ptr, size_t size, cudaStream_t stream) {
    return cudaMalloc(ptr, size);
}

template<class T>
__host__ cudaError_t cudaFreeAsync(T* ptr, cudaStream_t stream) {
    return cudaFree(ptr);
}
#endif

constexpr __device__ __host__ uint32_t CCSRRelation(uint32_t c) {
    uint32_t result = 0;
    for (uint32_t i = 0; i < c; i++) {
        result |= (1 << (31 - i));
    }
    return result;
}

constexpr __device__ __host__ uint32_t CCSRIndex(uint32_t c) {
    uint32_t result = 0;
    for (uint32_t i = 0; i < c; i++) {
        result |= (1 << i);
    }
    return result;
}

#endif
